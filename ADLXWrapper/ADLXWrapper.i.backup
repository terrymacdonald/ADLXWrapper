//
// Copyright (c) 2021 - 2025 Advanced Micro Devices, Inc. All rights reserved.
//
//-------------------------------------------------------------------------------------------------

%module(directors="1") ADLX
%{
#include <Windows.h>
#include "../ADLX/SDK/Include/ADLX.h"
#include "../ADLX/SDK/Include/ADLXDefines.h"
#include "../ADLX/SDK/Include/ADLXStructures.h"
#include "../ADLX/SDK/Include/ADLXVersion.h"
#include "../ADLX/SDK/Include/I3DSettings.h"
#include "../ADLX/SDK/Include/I3DSettings1.h"
#include "../ADLX/SDK/Include/I3DSettings2.h"
#include "../ADLX/SDK/Include/IApplications.h"
#include "../ADLX/SDK/Include/IChangedEvent.h"
#include "../ADLX/SDK/Include/ICollections.h"
#include "../ADLX/SDK/Include/IDesktops.h"
#include "../ADLX/SDK/Include/IDisplay3DLUT.h"
#include "../ADLX/SDK/Include/IDisplayGamma.h"
#include "../ADLX/SDK/Include/IDisplayGamut.h"
#include "../ADLX/SDK/Include/IDisplays.h"
#include "../ADLX/SDK/Include/IDisplays1.h"
#include "../ADLX/SDK/Include/IDisplays2.h"
#include "../ADLX/SDK/Include/IDisplays3.h"
#include "../ADLX/SDK/Include/IDisplaySettings.h"
#include "../ADLX/SDK/Include/IGPUAutoTuning.h"
#include "../ADLX/SDK/Include/IGPUManualFanTuning.h"
#include "../ADLX/SDK/Include/IGPUManualGFXTuning.h"
#include "../ADLX/SDK/Include/IGPUManualPowerTuning.h"
#include "../ADLX/SDK/Include/IGPUManualVRAMTuning.h"
#include "../ADLX/SDK/Include/IGPUPresetTuning.h"
#include "../ADLX/SDK/Include/IGPUTuning.h"
#include "../ADLX/SDK/Include/IGPUTuning1.h"
#include "../ADLX/SDK/Include/II2C.h"
#include "../ADLX/SDK/Include/ILog.h"
#include "../ADLX/SDK/Include/IMultiMedia.h"
#include "../ADLX/SDK/Include/IPerformanceMonitoring.h"
#include "../ADLX/SDK/Include/IPerformanceMonitoring1.h"
#include "../ADLX/SDK/Include/IPerformanceMonitoring2.h"
#include "../ADLX/SDK/Include/IPerformanceMonitoring3.h"
#include "../ADLX/SDK/Include/IPowerTuning.h"
#include "../ADLX/SDK/Include/IPowerTuning1.h"
#include "../ADLX/SDK/Include/ISmartAccessMemory.h"
#include "../ADLX/SDK/Include/ISystem.h"
#include "../ADLX/SDK/Include/ISystem1.h"
#include "../ADLX/SDK/Include/ISystem2.h"
#include "../ADLX/SDK/ADLXHelper/Windows/Cpp/ADLXHelper.h"
#include "ADLXQueryInterface.h"

typedef     int64_t             adlx_int64;
typedef     int32_t             adlx_int32;
typedef     int16_t             adlx_int16;
typedef     int8_t              adlx_int8;
typedef     uint64_t            adlx_uint64;
typedef     uint32_t            adlx_uint32;
typedef     uint16_t            adlx_uint16;
typedef     uint8_t             adlx_uint8;
typedef     size_t              adlx_size;
typedef     void*               adlx_handle;
typedef     double              adlx_double;
typedef     float               adlx_float;
typedef     void                adlx_void;
typedef     long                adlx_long;
typedef     adlx_int32          adlx_int;
typedef     unsigned long       adlx_ulong;
typedef     adlx_uint32         adlx_uint;
typedef     bool                adlx_bool;
typedef wchar_t WCHAR;    // wc,   16-bit UNICODE character
// TCHAR will be defined by windows.i

// Microsoft
#define ADLX_CORE_LINK          __declspec(dllexport)
#define ADLX_STD_CALL           __stdcall
#define ADLX_CDECL_CALL         __cdecl
#define ADLX_FAST_CALL          __fastcall
#define ADLX_INLINE              __inline
#define ADLX_FORCEINLINE         __forceinline
#define ADLX_NO_VTABLE          __declspec(novtable)

//IID's
#define ADLX_DECLARE_IID(X) static ADLX_INLINE const wchar_t* IID()  { return X; }
#define ADLX_IS_IID(X, Y) (!wcscmp (X, Y))
#define ADLX_DECLARE_ITEM_IID(X) static ADLX_INLINE const wchar_t* ITEM_IID()  { return X; }

using namespace adlx;
%}

typedef     int64_t             adlx_int64;
typedef     int32_t             adlx_int32;
typedef     int16_t             adlx_int16;
typedef     int8_t              adlx_int8;
typedef     uint64_t            adlx_uint64;
typedef     uint32_t            adlx_uint32;
typedef     uint16_t            adlx_uint16;
typedef     uint8_t             adlx_uint8;
typedef     size_t              adlx_size;
typedef     void*               adlx_handle;
typedef     double              adlx_double;
typedef     float               adlx_float;
typedef     void                adlx_void;
typedef     long                adlx_long;
typedef     adlx_int32          adlx_int;
typedef     unsigned long       adlx_ulong;
typedef     adlx_uint32         adlx_uint;
typedef     bool                adlx_bool;
typedef wchar_t WCHAR;    // wc,   16-bit UNICODE character
// TCHAR will be defined by windows.i

// Microsoft
#define ADLX_CORE_LINK          __declspec(dllexport)
#define ADLX_STD_CALL           __stdcall
#define ADLX_CDECL_CALL         __cdecl
#define ADLX_FAST_CALL          __fastcall
#define ADLX_INLINE              __inline
#define ADLX_FORCEINLINE         __forceinline
#define ADLX_NO_VTABLE          __declspec(novtable)

//IID's
#define ADLX_DECLARE_IID(X) static ADLX_INLINE const wchar_t* IID()  { return X; }
#define ADLX_IS_IID(X, Y) (!wcscmp (X, Y))

#define ADLX_DECLARE_ITEM_IID(X) static ADLX_INLINE const wchar_t* ITEM_IID()  { return X; }

/* Callback to turn on director wrapping */
%feature("director") IADLXDisplayListChangedListener;
%feature("director") IADLXGPUConnectChangedListener;
%feature("director") IADLXGPUAppsListChangedListener;

// Create a special pointer for us to use to get interface references
%apply void *VOID_INT_PTR { void * };

%include stdint.i
%include carrays.i
%include typemaps.i

// Define TCHAR before including windows.i to avoid redefinition warning
#ifndef TCHAR
typedef wchar_t TCHAR;
#endif

%include windows.i

// ADLX Runtime Detection and Validation Functions
bool IsADLXRuntimeAvailable();
ADLX_RESULT ValidateADLXInstallation();
const char* GetADLXErrorDescription(ADLX_RESULT result);

// QueryInterface Helper Functions for IADLXGPU2 Access
IADLXGPU1* QueryGPU1Interface(IADLXGPU* pGPU);
IADLXGPU2* QueryGPU2Interface(IADLXGPU* pGPU);
IADLXGPU2* QueryGPU2InterfaceFromGPU1(IADLXGPU1* pGPU1);

// System Interface QueryInterface Helpers
IADLXSystem1* QuerySystem1Interface(IADLXSystem* pSystem);
IADLXSystem2* QuerySystem2Interface(IADLXSystem* pSystem);
IADLXSystem2* QuerySystem2InterfaceFromSystem1(IADLXSystem1* pSystem1);

// Interface Capability Detection
bool SupportsGPU1Interface(IADLXGPU* pGPU);
bool SupportsGPU2Interface(IADLXGPU* pGPU);
bool SupportsSystem1Interface(IADLXSystem* pSystem);
bool SupportsSystem2Interface(IADLXSystem* pSystem);

// Gamma Ramp Data Access Helper Functions
ADLX_RESULT GetGammaRampData(ADLX_GammaRamp* pGammaRamp, adlx_uint16* pRedData, adlx_uint16* pGreenData, adlx_uint16* pBlueData, adlx_size dataSize);
ADLX_RESULT SetGammaRampData(ADLX_GammaRamp* pGammaRamp, const adlx_uint16* pRedData, const adlx_uint16* pGreenData, const adlx_uint16* pBlueData, adlx_size dataSize);
adlx_size GetGammaRampSize();
bool ValidateGammaRampData(const adlx_uint16* pData, adlx_size dataSize);

// Enhanced ADLX Helper Class
class EnhancedADLXHelper {
public:
    EnhancedADLXHelper();
    ADLX_RESULT Initialize();
    ADLX_RESULT Terminate();
    IADLXSystem* GetSystemServices();
    bool IsInitialized() const;
    ~EnhancedADLXHelper();
};

// Include base classes first to avoid undefined base class warnings
%include "../ADLX/SDK/Include/ADLX.h"
%include "../ADLX/SDK/Include/ADLXDefines.h"
%include "../ADLX/SDK/Include/ADLXStructures.h"
%include "../ADLX/SDK/Include/ADLXVersion.h"
%include "../ADLX/SDK/Include/IChangedEvent.h"
%include "../ADLX/SDK/Include/ICollections.h"
%include "../ADLX/SDK/Include/I3DSettings.h"
%include "../ADLX/SDK/Include/I3DSettings1.h"
%include "../ADLX/SDK/Include/I3DSettings2.h"
%include "../ADLX/SDK/Include/IApplications.h"
%include "../ADLX/SDK/Include/IDesktops.h"
%include "../ADLX/SDK/Include/IDisplay3DLUT.h"
%include "../ADLX/SDK/Include/IDisplayGamma.h"
%include "../ADLX/SDK/Include/IDisplayGamut.h"
%include "../ADLX/SDK/Include/IDisplays.h"
%include "../ADLX/SDK/Include/IDisplays1.h"
%include "../ADLX/SDK/Include/IDisplays2.h"
%include "../ADLX/SDK/Include/IDisplays3.h"
%include "../ADLX/SDK/Include/IDisplaySettings.h"
%include "../ADLX/SDK/Include/IGPUAutoTuning.h"
%include "../ADLX/SDK/Include/IGPUManualFanTuning.h"
%include "../ADLX/SDK/Include/IGPUManualGFXTuning.h"
%include "../ADLX/SDK/Include/IGPUManualPowerTuning.h"
%include "../ADLX/SDK/Include/IGPUManualVRAMTuning.h"
%include "../ADLX/SDK/Include/IGPUPresetTuning.h"
%include "../ADLX/SDK/Include/IGPUTuning.h"
%include "../ADLX/SDK/Include/IGPUTuning1.h"
%include "../ADLX/SDK/Include/II2C.h"
%include "../ADLX/SDK/Include/ILog.h"
%include "../ADLX/SDK/Include/IMultiMedia.h"
%include "../ADLX/SDK/Include/IPerformanceMonitoring.h"
%include "../ADLX/SDK/Include/IPerformanceMonitoring1.h"
%include "../ADLX/SDK/Include/IPerformanceMonitoring2.h"
%include "../ADLX/SDK/Include/IPerformanceMonitoring3.h"
%include "../ADLX/SDK/Include/IPowerTuning.h"
%include "../ADLX/SDK/Include/IPowerTuning1.h"
%include "../ADLX/SDK/Include/ISmartAccessMemory.h"
%include "../ADLX/SDK/Include/ISystem.h"
%include "../ADLX/SDK/Include/ISystem1.h"
%include "../ADLX/SDK/Include/ISystem2.h"
%include "../ADLX/SDK/ADLXHelper/Windows/Cpp/ADLXHelper.h"

using namespace adlx;

// T* pointer
%include cpointer.i

%pointer_functions(adlx_int, adlx_intP);
%pointer_functions(adlx_uint, adlx_uintP);
%pointer_functions(adlx_uint16, adlx_uint16P);
%pointer_functions(adlx_bool, adlx_boolP);
//%pointer_functions(adlx_string, adlx_stringP);
%pointer_functions(double, doubleP);
%pointer_functions(bool, boolP);
%pointer_functions(WCHAR, wcharP);
%pointer_functions(ADLX_DISPLAY_TYPE, adlx_displayTypeP);
%pointer_functions(ADLX_DISPLAY_CONNECTOR_TYPE, adlx_displayConnectTypeP);
%pointer_functions(ADLX_DISPLAY_SCAN_TYPE, adlx_displayScanTypeP);
%pointer_functions(adlx_size, adlx_sizeP);
%pointer_functions(ADLX_IntRange, adlx_intRangeP);
%pointer_functions(ADLX_ORIENTATION, adlx_orientationP);
%pointer_functions(ADLX_Point, adlx_pointP);
%pointer_functions(ADLX_3DLUT_Data, adlx_3dlutP);
%pointer_functions(ADLX_CustomResolution, adlx_customResolutionP);
%pointer_functions(ADLX_GammaRamp, adlx_gamaRampP);
%pointer_functions(ADLX_GamutColorSpace, adlx_gamutColorSpaceP);
%pointer_functions(ADLX_LUID, adlx_luidP);
%pointer_functions(ADLX_RGB, adlx_rgbP);
%pointer_functions(ADLX_RegammaCoeff, adlx_regammaCoeffP);
%pointer_functions(ADLX_TimingInfo, adlx_timingInfoP);
%pointer_functions(ADLX_3DLUT_COLORSPACE, adlx_3dlutColorSpaceP);
%pointer_functions(ADLX_3DLUT_TRANSFER_FUNCTION, adlx_3dlutTransferFunctionP);
%pointer_functions(ADLX_ANISOTROPIC_FILTERING_LEVEL, adlx_anisotropicFilteringLevelP);
%pointer_functions(ADLX_ANTILAG_STATE, adlx_antilagStateP);
%pointer_functions(ADLX_ANTI_ALIASING_LEVEL, adlx_antiAliasingLevelP);
%pointer_functions(ADLX_ANTI_ALIASING_METHOD, adlx_antiAliasingMethodP);
%pointer_functions(ADLX_ANTI_ALIASING_MODE, adlx_antiAliasingModeP);
%pointer_functions(ADLX_COLOR_DEPTH, adlx_colorDepthP);
%pointer_functions(ADLX_DESKTOP_TYPE, adlx_desktopTypeP);
%pointer_functions(ADLX_DISPLAY_TIMING_LIMITATION, adlx_displayTimingLimitationP);
%pointer_functions(ADLX_DISPLAY_TIMING_POLARITY, adlx_displayTimingPolarityP);
%pointer_functions(ADLX_DP_LINK_RATE, adlx_dpLinkRateP);
%pointer_functions(ADLX_GAMMA_TYPE, adlx_GammaTypeP);
%pointer_functions(ADLX_GAMUT_SPACE, adlx_GamutSpaceP);
%pointer_functions(ADLX_GPU_TYPE, adlx_gpuTypeP);
%pointer_functions(ADLX_HG_TYPE, adlx_hgTypeP);
%pointer_functions(ADLX_I2C_LINE, adlx_i2cLineP);
%pointer_functions(ADLX_MEMORYTIMING_DESCRIPTION, adlx_memoryTimingDescriptionP);
%pointer_functions(ADLX_MGPU_MODE, adlx_mgpuModeP);
%pointer_functions(ADLX_PCI_BUS_TYPE, adlx_pciBusTypeP);
%pointer_functions(ADLX_PIXEL_FORMAT, adlx_pixelFormatP);
%pointer_functions(ADLX_RESULT, adlx_resultP);
%pointer_functions(ADLX_SCALE_MODE, adlx_scaleModeP);
%pointer_functions(ADLX_SMARTSHIFT_ECO_INACTIVE_REASON, adlx_smartshiftEcoInactiveReasonP);
%pointer_functions(ADLX_SSM_BIAS_MODE, adlx_ssmBiasModeP);
%pointer_functions(ADLX_SYNC_ORIGIN, adlx_syncOriginP);
%pointer_functions(ADLX_TESSELLATION_LEVEL, adlx_tessellationLevelP);
%pointer_functions(ADLX_TESSELLATION_MODE, adlx_tessellationModeP);
%pointer_functions(ADLX_TIMING_STANDARD, adlx_timingStandardP);
%pointer_functions(ADLX_WAIT_FOR_VERTICAL_REFRESH_MODE, adlx_waitForVerticalRefreshModeP);
%pointer_functions(ADLX_WHITE_POINT, adlx_whitePointP);
%pointer_functions(ADLX_LOG_DESTINATION, adlx_logDestinationP);
%pointer_functions(ADLX_LOG_SEVERITY, adlx_logSeverityP);
%pointer_functions(ADLX_APP_GPU_DEPENDENCY, adlx_appGpuDependencyP);



// T** pointers
%pointer_functions(IADLXDisplayServices*, displaySerP_Ptr);
%pointer_functions(IADLXDisplayServices1*, displaySer1P_Ptr);
%pointer_functions(IADLXDisplayServices2*, displaySer2P_Ptr);
%pointer_functions(IADLXDisplayServices3*, displaySer3P_Ptr);
%pointer_functions(IADLXDisplayList*, displayListP_Ptr);
%pointer_functions(IADLXDisplay*, displayP_Ptr);
%pointer_functions(IADLXDisplayChangedHandling*, displayChangeHandlP_Ptr);
%pointer_functions(IADLXDesktopServices*, desktopSerP_Ptr);
%pointer_functions(IADLXDesktopList*, desktopListP_Ptr);
%pointer_functions(IADLXDesktop*, desktopP_Ptr);
%pointer_functions(IADLXDesktopChangedHandling*, desktopChangeHandlP_Ptr);
%pointer_functions(IADLXEyefinityDesktop*, eyefinityDesktopP_Ptr);
%pointer_functions(IADLXSimpleEyefinity*, simpleEyefinityP_Ptr);
%pointer_functions(IADLXGPU*, gpuP_Ptr);
%pointer_functions(IADLXGPU1*, gpu1P_Ptr);
%pointer_functions(IADLXGPU2*, gpu2P_Ptr);
%pointer_functions(IADLXGPUList*, gpuListP_Ptr);
%pointer_functions(IADLXList*, adlxListP_Ptr);
%pointer_functions(IADLXInterface*, adlxInterfaceP_Ptr);
%pointer_functions(IADLXGPUTuningServices*, gpuTuningP_Ptr);
%pointer_functions(IADLXManualFanTuning*, manualFanTuningP_Ptr);
%pointer_functions(IADLXManualPowerTuning*, manualPowerTuningP_Ptr);
%pointer_functions(IADLXPerformanceMonitoringServices*, performanceP_Ptr);
%pointer_functions(IADLXManualFanTuningStateList*, fanTuningStateListP_Ptr);
%pointer_functions(IADLXManualFanTuningState*, fanTuningStateP_Ptr);
%pointer_functions(IADLXGPUMetrics*, metricsP_Ptr);
%pointer_functions(IADLXGPUMetrics1*, metrics1P_Ptr);
%pointer_functions(IADLXGPUMetricsSupport*, metricsSupportP_Ptr);
%pointer_functions(IADLXGPUMetricsSupport1*, metricsSupport1P_Ptr);
//%pointer_functions(adlx_string*, stringP_Ptr);
%pointer_functions(IADLXGPUMetricsList*, gpuMetricsListP_Ptr);
%pointer_functions(char*, charP_Ptr);
%pointer_functions(void*, voidP_Ptr);
%pointer_functions( IADLXDisplay3DLUT*, display3DLUTP_Ptr);
%pointer_functions( IADLXDisplayColorDepth*, displayColorDepthP_Ptr);
%pointer_functions( IADLXDisplayCustomColor*, displayCustomColorP_Ptr);
%pointer_functions( IADLXDisplayCustomResolution*, displayCustomResolutionP_Ptr);
%pointer_functions( IADLXDisplayFreeSync*, displayFreeSyncP_Ptr);
%pointer_functions( IADLXDisplayGPUScaling*, displayGPUScalingP_Ptr);
%pointer_functions( IADLXDisplayGamma*, displayGammaP_Ptr);
%pointer_functions( IADLXDisplayGamut*, displayGamutP_Ptr);
%pointer_functions( IADLXDisplayHDCP*, displayHDCPP_Ptr);
%pointer_functions( IADLXDisplayIntegerScaling*, displayIntegerScalingP_Ptr);
%pointer_functions( IADLXDisplayPixelFormat*, displayPixelFormatP_Ptr);
%pointer_functions( IADLXDisplayScalingMode*, displayScalingModeP_Ptr);
%pointer_functions( IADLXDisplayVariBright*, displayVariBrightP_Ptr);
%pointer_functions( IADLXDisplayVSR*, displayVSRP_Ptr);
%pointer_functions( IADLXDisplayBlanking*, displayDisplayBlankingP_Ptr);
%pointer_functions( IADLXDisplayConnectivityExperience*, displayConnectivityExperienceP_Ptr);
%pointer_functions( IADLXDisplayDynamicRefreshRateControl*, displayDynamicRefreshRateControlP_Ptr);
%pointer_functions( IADLXDisplayFreeSyncColorAccuracy*, displayCFreeSyncColorAccuracyP_Ptr);


// T** ppointer
%define %ppointer_functions(TYPE,NAME)
%{
static TYPE *new_##NAME() { %}
%{  return new TYPE(); %}
%{}

static TYPE *copy_##NAME(TYPE value) { %}
%{  return new TYPE(value); %}
%{}

static void delete_##NAME(TYPE *obj) { %}
%{  if (*obj) delete *obj; %}
%{}

static void NAME ##_assign(TYPE *obj, TYPE value) {
  *obj = value;
}

static TYPE NAME ##_value(TYPE *obj) {
  return *obj;
}
%}

TYPE *new_##NAME();
TYPE *copy_##NAME(TYPE value);
void  delete_##NAME(TYPE *obj);
void  NAME##_assign(TYPE *obj, TYPE value);
TYPE  NAME##_value(TYPE *obj);

%enddef

%define %pointer_cast(TYPE1,TYPE2,NAME)
%inline %{
TYPE2 NAME(TYPE1 x) {
   return (TYPE2) x;
}
%}
%enddef

/* %pointer_cast(IADLXManualFanTuning**, void**, CastManualFanTuningVoidPtr);
%pointer_cast(IADLXManualPowerTuning**, void**, CastManualPowerTuningVoidPtr);

%pointer_cast(IADLXGPUMetrics**, IADLXGPUMetrics1**, CastGPUMetricsToGPUMetrics1);
%pointer_cast(IADLXGPUMetricsSupport**, IADLXGPUMetricsSupport1**, CastGPUMetricsSupportToGPUMetricsSupport1); */